---
# https://github.com/ansible/ansible/issues/70304 and https://github.com/konstruktoid/ansible-docker-rootless/commit/8a7cd7b2371229a8d857d5896cd5c132b679afc3
- name: Force an update of facts
  setup: ~

- name: Include OS-specific variables
  include_vars: "{{ item }}"
  with_first_found:
    - "{{ ansible_os_family }}.yml"
    - "default.yml"

- name: Set banner file (non-Ubuntu)
  template:
    src: banner.j2
    dest: /etc/motd
    force: yes
  when: ansible_distribution != 'Ubuntu'

- name: Set banner file (Ubuntu)
  template:
    src: banner-Ubuntu.j2
    dest: /etc/update-motd.d/00-header
    force: yes
  when: ansible_distribution == 'Ubuntu'
