---
- name: Download Julia tarball
  get_url:
    url: "https://julialang-s3.julialang.org/bin/linux/x64/{{ neurodesk_julia_version | regex_replace('^([0-9])\\.([0-9]*).*', '\\1.\\2') }}/julia-{{ neurodesk_julia_version }}-linux-x86_64.tar.gz"
    dest: /tmp/julia-{{ neurodesk_julia_version }}-linux-x86_64.tar.gz

- name: Unarchive Julia tarball
  unarchive:
    src: "/tmp/julia-{{ neurodesk_julia_version }}-linux-x86_64.tar.gz"
    dest: /opt
    remote_src: yes

- name: Remove downloaded tarball
  file:
    path: "/tmp/julia-{{ neurodesk_julia_version }}-linux-x86_64.tar.gz"
    state: absent

- name: Create a symbolic link
  file:
    src: "/opt/julia-{{ neurodesk_julia_version }}"
    dest: /opt/julia-latest
    state: link
